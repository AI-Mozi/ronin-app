<h1>Vulnerabilities</h1>

<form id="recon" action="/vulns" method="post">
  <div class="field">
    <label class="label is-required">URL</label>

    <div class="control">
      <% if @errors && @errors[:url] %>
        <input class="input is-danger" name="url" required><%=h params[:url] %></input>

        <% @errors[:url].each do |error| %>
        <p class="help is-danger"><%=h error %></p>
        <% end %>
      <% else %>
        <input class="input" name="url" placeholder="https://example.com" required><%=h params[:url] %></input>
      <% end %>
    </div>
  </div>

  <div class="field">
    <button type="submit" class="button is-primary">Scan</button>
  </div>

  <div class="advanced">
    <a class="advanced-toggle">Advanced Options</a>

    <div class="advanced-content">
      <h3>LFI</h3>

      <div class="field">
        <label class="label">Os</label>

        <div class="control">
          <% if @errors && @errors.dig(:lfi, :os) %>
            <input class="input is-danger" type="text" name="lfi[os]" value="<%=hattr params.dig(:lfi, :os) %>">

            <% @errors[:lfi][:os].each do |error| %>
              <p class="help is-danger"><%=h error %></p>
            <% end %>
          <% else %>
            <input class="input" type="text" name="lfi[os]" placeholder=":unix" value="<%=hattr params.dig(:lfi, :os) %>">
          <% end %>
        </div>
      </div>

      <div class="field">
        <label class="label">Depth</label>

        <div class="control">
          <% if @errors && @errors.dig(:lfi, :depth) %>
            <input class="input is-danger" type="text" name="lfi[depth]" value="<%=hattr params.dig(:lfi, :depth) %>">

            <% @errors[:lfi][:depth].each do |error| %>
              <p class="help is-danger"><%=h error %></p>
            <% end %>
          <% else %>
            <input class="input" type="text" name="lfi[depth]" placeholder="6" value="<%=hattr params.dig(:lfi, :depth) %>">
          <% end %>
        </div>
      </div>

      <div class="field">
        <label class="label">Filter Bypass</label>

        <div class="control">
          <% if @errors && @errors.dig(:rfi, :filter_bypass) %>
            <input class="input is-danger" type="text" name="lfi[filter_bypass]" value="<%=hattr params.dig(:lfi, :filter_bypass) %>">

            <% @errors[:lfi][:filter_bypass].each do |error| %>
              <p class="help is-danger"><%=h error %></p>
            <% end %>
          <% else %>
            <input class="input" type="text" name="lfi[filter_bypass]" placeholder=":nullbyte, :double_escape, :base64, :rot13 or :zlib" value="<%=hattr params.dig(:lfi, :filter_bypass) %>">
          <% end %>
        </div>
      </div>

      <h3>RFI</h3>

      <div class="field">
        <label class="label">Filter Bypass</label>

        <div class="control">
          <% if @errors && @errors.dig(:rfi, :filter_bypass) %>
            <input class="input is-danger" type="text" name="rfi[filter_bypass]" value="<%=hattr params.dig(:rfi, :filter_bypass) %>">

            <% @errors[:rfi][:filter_bypass].each do |error| %>
              <p class="help is-danger"><%=h error %></p>
            <% end %>
          <% else %>
            <input class="input" type="text" name="rfi[filter_bypass]" placeholder=":double_encode, :suffix_escape or :null_byte" value="<%=hattr params.dig(:rfi, :filter_bypass) %>">
          <% end %>
        </div>
      </div>

      <div class="field">
        <label class="label">Test Script URL</label>

        <div class="control">
          <% if @errors && @errors.dig(:rfi, :test_script_url) %>
            <input class="input is-danger" type="text" name="rfi[test_script_url]" value="<%=hattr params.dig(:rfi, :test_script_url)%>">

            <% @errors[:rfi][:test_script_url].each do |error| %>
              <p class="help is-danger"><%=h error %></p>
            <% end %>
          <% else %>
            <input class="input" type="text" name="rfi[test_script_url]" value="<%=hattr params.dig(:rfi, :test_script_url) %>">
          <% end %>
        </div>
      </div>

      <h3>SQLI</h3>

      <div class="field">
        <label class="has-text-weight-semibold">Escape Quote: </label>
        <input class="checkbox" type="checkbox" name="sqli[escape_quote]"<%= " checked" if params.dig(:sqli, :terminate) %>
      </div>

      <div class="field">
        <label class="has-text-weight-semibold">Escape Parens: </label>
        <input class="checkbox" type="checkbox" name="sqli[escape_parens]"<%= " checked" if params.dig(:sqli, :terminate) %>
      </div>

      <div class="field">
        <label class="has-text-weight-semibold">Terminate: </label>
        <input class="checkbox" type="checkbox" name="sqli[terminate]"<%= " checked" if params.dig(:sqli, :terminate) %>
      </div>

      <h3>SSTI</h3>

      <div class="field">
        <label class="label">Escape</label>

        <div class="control">
          <% if @errors && @errors.dig(:ssti, :escape) %>
            <input class="input is-danger" type="text" name="ssti[escape]" value="<%=hattr params.dig(:ssti, :escape) %>">

            <% @errors[:ssti][:escape].each do |error| %>
              <p class="help is-danger"><%=h error %></p>
            <% end %>
          <% else %>
            <input class="input" type="text" name="ssti[escape]" value="<%=hattr params.dig(:ssti, :escape) %>">
          <% end %>
        </div>
      </div>

      <div class="field">
        <label class="label">Test</label>

        <div class="control">
          <% if @errors && @errors.dig(:ssti, :test) %>
            <input class="input is-danger" type="text" name="ssti[test]" value="<%=hattr params.dig(:ssti, :test)%>">

            <% @errors[:ssti][:test].each do |error| %>
              <p class="help is-danger"><%=h error %></p>
            <% end %>
          <% else %>
            <input class="input" type="text" name="ssti[test]" value="<%=hattr params.dig(:ssti, :test)%>">
          <% end %>
        </div>
      </div>

      <h3>Open Redirect</h3>

      <div class="field">
        <label class="label">Test URL</label>

        <div class="control">
          <% if @errors && @errors.dig(:open_redirect, :test_url) %>
            <input class="input is-danger" type="text" name="open_redirect[test_url]" value="<%=hattr params.dig(:open_redirect, :test_url)%>">

            <% @errors[:open_redirect][:test_url].each do |error| %>
              <p class="help is-danger"><%=h error %></p>
            <% end %>
          <% else %>
            <input class="input" type="text" name="open_redirect[test_url]" value="<%=hattr params.dig(:open_redirect, :test_url)%>">
          <% end %>
        </div>
      </div>
    </div>
  </div>
</form>
